<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Obsidian+ ‚Äî Programmable Productivity, Your Way</title>
  <meta name="description" content="A programmable Obsidian plugin that turns your vault into a living system. See live demos, real use cases, and grab a starter vault pre‚Äëconfigured in minutes." />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 256 256'><path fill='%235960f1' d='M128 10 30 74v108l98 64 98-64V74z'/></svg>">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.css">
  <style>
    /*
      ==============================
      THEME LAYER ‚Äî Obsidian-ish
      ==============================
      If you want this page to inherit your Obsidian theme, paste your theme's CSS variables
      here (usually found in .obsidian/themes/<Theme>.css), especially color tokens like:
      --background-primary, --background-secondary, --text-normal, --text-muted,
      --interactive-accent, --accent-strong, --background-modifier-border, etc.
      Keep the variable names below and override their values.
    */
    :root {
      /* Light defaults */
      --bg-primary: #f7f7f8;             /* ‚âà background-primary */
      --bg-secondary: #ffffff;           /* ‚âà background-secondary */
      --bg-elevated: #ffffffee;
      --text-normal: #1b1f23;            /* ‚âà text-normal */
      --text-muted: #5f6b7a;             /* ‚âà text-muted */
      --accent: #5960f1;                 /* ‚âà interactive-accent */
      --accent-strong: #3b41dd;          /* ‚âà accent-strong */
      --border: #e5e7eb;                 /* ‚âà background-modifier-border */
      --callout-bg: #eef2ff;
      --success: #16a34a;
      --warning: #f59e0b;
      --danger:  #ef4444;
      --shadow: 0 8px 28px rgba(0,0,0,.08);
      --radius-xl: 12px;
      --radius-lg: 8px;
      --radius-md: 6px;
      --content-max: 1080px;
      --font-sans: ui-sans-serif, -apple-system, Segoe UI, Roboto, Inter, system-ui, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }

    /* Dark mode (auto + toggle) */
    :root[data-theme="dark"] {
      --bg-primary: #121317;
      --bg-secondary: #171922;
      --bg-elevated: #171922ee;
      --text-normal: #e7eaf0;
      --text-muted: #a2a8b6;
      --accent: #7b7ffb;
      --accent-strong: #6366f1;
      --border: #262b35;
      --callout-bg: #1e2232;
      --shadow: 0 12px 36px rgba(0,0,0,.35);
    }

    /* Base */
    html, body { height: 100%; }
    body {
      margin: 0; background: var(--bg-primary); color: var(--text-normal);
      font-family: var(--font-sans); line-height: 1.6; -webkit-font-smoothing: antialiased;
    }
    a { color: var(--accent); text-decoration: none; }
    a:hover { color: var(--accent-strong); }
    .container { width: 100%; max-width: var(--content-max); margin: 0 auto; padding: 0 20px; }
    .btn { display: inline-flex; align-items: center; gap: 10px; padding: 12px 18px; border-radius: var(--radius-lg); border: 1px solid var(--border); background: var(--bg-secondary); box-shadow: var(--shadow); font-weight: 600; }
    .btn.primary { background: linear-gradient(180deg, var(--accent), var(--accent-strong)); color: white; border-color: transparent; }
    .btn.ghost { background: transparent; }
    .pill { display: inline-flex; align-items: center; gap: 8px; padding: 6px 10px; border-radius: var(--radius-md); border: 1px solid var(--border); background: var(--bg-secondary); font-size: 12px; color: var(--text-muted); }
    .kbd { font-family: var(--font-mono); font-size: 12px; border: 1px solid var(--border); border-bottom-width: 3px; padding: 2px 6px; border-radius: 6px; background: var(--bg-secondary); }
    .card { background: var(--bg-secondary); border: 1px solid var(--border); border-radius: var(--radius-xl); box-shadow: var(--shadow); }
    .grid { display: grid; gap: 12px; }

    /* Nav */
    header { position: sticky; top: 0; z-index: 50; backdrop-filter: blur(10px); background: color-mix(in srgb, var(--bg-primary) 85%, transparent); border-bottom: 1px solid var(--border); }
    .hero .tagline { font-size: 24px; color: var(--accent); font-style: italic; }
    .nav { display: flex; align-items: center; justify-content: space-between; height: 64px; }
    .logo { display: flex; align-items: center; gap: 12px; font-weight: 800; letter-spacing: .2px; }
    .logo svg { width: 24px; height: 24px; }
    .nav a { color: var(--text-muted); font-weight: 600; margin-left: 16px; }
    .nav a:hover { color: var(--text-normal); }

    /* Hero */
    .hero { padding: 72px 0 56px; position: relative; }
    .hero h1 { font-size: clamp(28px, 5vw, 44px); line-height: 1.1; margin: 0 0 14px; }
    .hero p { font-size: clamp(16px, 2.2vw, 18px); color: var(--text-muted); margin: 0 0 26px; }
    .hero .cta { display: flex; gap: 12px; flex-wrap: wrap; }
    .hero-visual { margin-top: 28px; border-radius: var(--radius-xl); overflow: hidden; border: 1px solid var(--border); box-shadow: var(--shadow); }
    .hero-visual img { width: 100%; display: block; }

    /* Social proof */
    .proof { display: grid; grid-template-columns: repeat(3, 1fr); gap: 14px; margin-top: 24px; }
    .proof .meter { padding: 12px 14px; border-radius: var(--radius-md); border: 1px solid var(--border); background: var(--bg-secondary); font-size: 14px; color: var(--text-muted); display:flex; align-items:center; gap:10px; }

    /* Sections */
    section { padding: 56px 0; }
    h2 { font-size: clamp(22px, 3.4vw, 32px); margin: 0 0 10px; }
    .sub { color: var(--text-muted); margin-top: 6px; }

    /* Features */
    .features { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); }
    .feature { padding: 18px; }
    .feature h3 { margin: 0 0 4px; font-size: 18px; }
    .feature p { margin: 0; color: var(--text-muted); }

    /* Demo */
    .demo-wrap { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .panel { padding: 12px; }
    .demo-controls .row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px; }
    .demo-controls label { font-size: 12px; color: var(--text-muted); display:block; margin-bottom:4px; }
    .demo-controls input, .demo-controls select { width: 100%; padding: 10px 12px; border: 1px solid var(--border); border-radius: 10px; background: var(--bg-secondary); color: var(--text-normal);
      box-shadow: inset 0 1px 0 rgba(0,0,0,.02); }
    .note-tabs { display:flex; gap:8px; flex-wrap: wrap; margin: 8px 0px; }
    .note-tab { font-size:12px; padding:6px 10px; border:1px dashed var(--border); border-radius:var(--radius-md); background:transparent; cursor:pointer; }
    .note-tab.active, .note-tab:hover { border-color:var(--accent); color:var(--accent); }

    table { width: 100%; border-collapse: collapse; }
    th, td { text-align: left; padding: 2px 10px; font-size: 14px; }
    th { font-weight: 700; }
    tr.item { cursor:pointer; }
    tr.item:hover { background: var(--bg-elevated); }
    tr.details { display:none; }
    tr.details.show { display:table-row; }
    tr.details ul { margin: 0; }
    .table-wrap + .table-wrap { margin-top:20px; }

    .badge {
      display:inline-block; color:#fff; padding:0px 5px; border-radius:10px; font-size:12px;
    }

    /* CodeMirror tweaks */
    .CodeMirror { height:100%; border:1px solid var(--border); border-radius: var(--radius-md); font-size:13px; background:var(--callout-bg); color:var(--text-normal); }
    .CodeMirror-lines { padding:10px; }
    .cm-tag { color:#fff; border-radius:10px; padding:1px 5px; line-height: normal; display:inline-block; }

    #notePanel { display:flex; flex-direction:column; }
    #editorWrap { flex:1; min-height:360px; }

    /* .rendered-note {  } */
    .card table { margin-bottom: 5px; }
    .note-list { list-style: disc; padding-left:20px; margin:0; }
    .note-list li { margin-bottom:4px; }
    .note-list .due { color: var(--text-muted); }
    .due { color: var(--text-muted); }

    /* Callouts */
    .callout { background: var(--callout-bg); border: 1px solid var(--border); border-radius: var(--radius-lg); padding: 14px 16px; }

    /* Footer */
    footer { padding: 40px 0; border-top: 1px solid var(--border); color: var(--text-muted); }

    /* Responsive */
    @media (max-width: 960px) { .demo-wrap { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <div class="logo">
        <svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M128 10L30 74v108l98 64 98-64V74L128 10Z" fill="currentColor"/></svg>
        <span>Obsidian<span style="color:var(--accent)">+</span></span>
      </div>
      <nav>
        <a href="#story">Story</a>
        <a href="#use-cases">Use cases</a>
        <a href="#demo">Live demo</a>
        <a href="#download">Download</a>
        <a id="themeToggle" class="pill" href="#">Toggle <span class="kbd">‚åò/Ctrl</span> + <span class="kbd">D</span></a>
      </nav>
    </div>
  </header>

  <main>
    <!-- HERO -->
    <section class="hero">
      <div class="container">
        <span class="pill">Programmable plugin ‚Ä¢ No fluff, real workflows</span>
        <div class="title">
          <h1>From Notes to Systems ‚Äî Instantly.</h1>
          <p class="tagline">Track projects, streamline SOPs, and automate your workflows - without setup.</p>
        </div>
        <p>I've used this setup for over a year to juggle research, product work, and family life. It can fire events, 
          run tasks, and call APIs directly from your notes, written in intuitive <strong>Markdown</strong> - putting the full power of no-code 
          tools at your fingertips, without clunky drag-and-drop interfaces. Track status of your team's work, send them tasks/tickets 
          to work on, and communicate with customers directly from your notebook. Receive payment notifications, status updates directly in your project, no context switch.</p>
        <div class="cta">
          <a href="#demo" class="btn primary">‚ñ∂ Try the Live Demo</a>
          <a href="#download" class="btn">‚¨á Get the Starter Vault</a>
          <a href="#use-cases" class="btn ghost">üìö See Use Cases</a>
        </div>
        <!-- <div class="proof">
          <div class="meter">‚ö° Saves ~4‚Äì6 hrs/week</div>
          <div class="meter">üß© Works with Dataview</div>
          <div class="meter">üõ†Ô∏è Scriptable JS actions</div>
        </div> -->
        <div class="hero-visual card">
          <!-- Replace with your animated GIF or screenshot from your vault -->
          <!-- <img alt="Plugin screenshot" src="https://images.unsplash.com/photo-1555066931-4365d14bab8c?q=80&w=1400&auto=format&fit=crop" /> -->
          <img alt="Plugin screenshot" src="./preview.png" />
        </div>
      </div>
    </section>

    <!-- STORY -->
    <section id="story">
      <div class="container">
        <h2>Why I built it</h2>
        <p class="sub">I needed one keyboard-driven place to capture ideas, triage tasks, and spin up repeatable workflows in seconds‚Äîwithout leaving my notes.</p>
        <div class="grid features" style="margin-top:18px;">
          <div class="feature card">
            <h3>Capture ‚Üí Classify ‚Üí Act</h3>
            <p>Turn scribbles into structured items with frontmatter autofill and smart templates. No more copy/paste gymnastics.</p>
          </div>
          <div class="feature card">
            <h3>Dataview superpowers</h3>
            <p>Use your existing metadata to render boards, tables, and rollups. Keep notes markdown‚Äëpure; let the views do the heavy lifting.</p>
          </div>
          <div class="feature card">
            <h3>Programmable actions</h3>
            <p>Attach small JS snippets to commands: file ops, link graphs, recurring reviews, outbound webhooks, and more.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- USE CASES -->
    <section id="use-cases">
      <div class="container">
        <h2>How it actually feels in a real vault</h2>
        <p class="sub">Three slices from my workflow, mirrored by the live demo below.</p>
        <div class="grid features" style="margin-top:18px;">
          <div class="feature card"><h3>Daily note ‚Üí Notes & Tasks</h3><p>Free-form jotting in <em>Notes & Tasks</em> (hashtags + dates inline). The plugin parses as you type and routes items where they belong.</p></div>
          <div class="feature card"><h3>Top-of-note Dashboard</h3><p>A lightweight overview at the top of the daily note: counts by tag (#todo, #waiting, #urgent) and a short list of upcoming items.</p></div>
          <div class="feature card"><h3>Music library from notes</h3><p>Lines tagged <code>#music</code> (optionally with a date + URL) roll into a curated ‚ÄúMusic‚Äù view with search and quick open.</p></div>
        </div>
      </div>
    </section>

    <!-- LIVE DEMO (Dataview‚Äëish) -->
    <section id="demo">
      <div class="container">
        <h2>Live demo (notes ‚Üí dashboards)</h2>
        <p class="sub">Type content in the left pane like you would in your notes. The right pane auto-generates dashboards based on a database built from your notes.</p>
    
        <div class="demo-wrap" style="align-items:start;">
          <!-- LEFT: Note editor -->
          <div id="notePanel" class="card panel">
            <div style="font-weight:700;">Notes (type here)</div>
            <div class="note-tabs">
              <button class="note-tab active" data-note="Daily Note">Daily Note</button>
              <button class="note-tab" data-note="Transaction Log">Transaction Log</button>
              <button class="note-tab" data-note="Project Note">Project Note</button>
            </div>
            <div id="editorWrap">
              <textarea id="noteInput" spellcheck="false"></textarea>
            </div>
            <label style="display:flex;align-items:center;gap:6px;font-size:13px;color:var(--text-muted);margin-top:8px;">
              <input id="includePad" type="checkbox" checked style="accent-color:var(--accent);"> Add a few sample items from other notes (to simulate vault-wide rollups)
            </label>
            <!-- <div class="callout" style="margin-top:8px;">
              Tip: In your vault, the plugin reads actual notes (frontmatter + lines) and writes real views. This demo just shows the <em>feel</em> of the flow.
            </div> -->
          </div>

          <!-- RIGHT: Preview -->
          <div id="previewPanel" class="panel" style="padding:0;">
            <!-- <div style="font-weight:700; margin:12px;">Preview</div> -->
            <div id="viewContainer" class="rendered-note"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- DOWNLOAD -->
    <section id="download">
      <div class="container">
        <h2>Get the starter vault</h2>
        <p class="sub">Download a fresh Obsidian vault with the plugin pre‚Äëconfigured, example notes, and ready‚Äëmade views.</p>
        <div class="card panel">
          <ol>
            <li><strong>Download:</strong> <a href="/downloads/obsidianplus-starter.zip">obsidianplus-starter.zip</a> (place the file in <code>~/Downloads</code> on your machine).</li>
            <li><strong>Open in Obsidian:</strong> Unzip ‚Üí ‚ÄúOpen folder as vault‚Äù.</li>
            <li><strong>Enable community plugins:</strong> Settings ‚Üí Community Plugins ‚Üí <em>On</em> ‚Üí trust this vault.</li>
            <li><strong>Start:</strong> Open <code>üìå Start Here.md</code> for a 2‚Äëminute tour.</li>
          </ol>
          <p class="sub">Note: Obsidian Publish doesn‚Äôt run community plugins. This site simulates outputs; the vault runs the real thing.</p>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container">
      <div style="display:flex;justify-content:space-between;gap:16px;flex-wrap:wrap;align-items:center;">
        <div>¬© <span id="year"></span> Obsidian+. Built with plain HTML+JS. No tracking by default.</div>
        <div><a href="#" id="copyThemeBtn" class="pill">How to use my Obsidian theme ‚Üí</a></div>
      </div>
    </div>
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/markdown/markdown.min.js"></script>
  <script>
    // === Dark mode: auto + toggle + persisted ===
    (function() {
      const root = document.documentElement;
      const saved = localStorage.getItem('theme');
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      root.dataset.theme = saved || (prefersDark ? 'dark' : 'light');
      const t = document.getElementById('themeToggle');
      if (t) t.addEventListener('click', (e) => { e.preventDefault(); toggleTheme(); });
      function toggleTheme(){ root.dataset.theme = root.dataset.theme === 'dark' ? 'light' : 'dark'; localStorage.setItem('theme', root.dataset.theme); }
      window.addEventListener('keydown', (ev) => { if ((ev.metaKey || ev.ctrlKey) && ev.key.toLowerCase() === 'd') { toggleTheme(); ev.preventDefault(); } });
    })();
    
    // === Elements ===
    const includePadEl = document.getElementById('includePad');
    const containerEl = document.getElementById('viewContainer');
    const cm = CodeMirror.fromTextArea(document.getElementById('noteInput'), {
      lineNumbers: false,
      lineWrapping: true,
      mode: 'markdown'
    });
    cm.addOverlay({
      token: function(stream) {
        if (stream.match(/#[A-Za-z0-9_-]+/)) return 'tag';
        while (stream.next() != null && !stream.match(/#[A-Za-z0-9_-]+/, false)) {}
        return null;
      }
    });
    cm.on('change', render);
    
    // === Notes ===
    const NOTES = {
      'Daily Note':
`Dump anything that comes to mind into your daily notes, all information will self-organize into a database:
- 15 Boardwalk: guest-reported issues
	- [ ] #todo check leak under fridge
		- guest says they saw a small puddle
	- [ ] #todo restock coffee and paper towels

- [ ] #todo 5 Bow St: replace smoke detectors
	- had false alarm recently
	- they're ~8 years old now, time to update

Personal assistant directly in your notebook that pulls the context from your notes:
- I need to estimate construction costs for a 2000 sqft house in 02465 zip
	- [x] #chatgpt can you ballpark this? ‚úÖ 2025-08-17‚úì‚úì
	    + Construction costs for a 2000 sqft house in zip code 02465 (Newton, MA) can range **$400,000‚Äì$800,000+** depending on finishes and labor.
	        + Low-end: Basic finishes, modular/prefab (~$200/sqft)
	        + Mid-range: Custom build with standard materials (~$300‚Äì$400/sqft)
	        + High-end: Luxury finishes, complex design (~$400+/sqft)
	    + Factors impacting cost:
	        + Land/prep (steep lots or rocky soil increase expenses)
	        + Local permitting fees and labor rates (Boston area is ~20% above national avg)
	        + Material choices (e.g., hardwood vs. laminate)
	    + Verify with local contractors for precise bids.

Document music that helps you focus:
- #music Midnight Flow Music ‚Äî Night Bass
	- https://www.youtube.com/watch?v=AVmyklX6LEA
	- calm, focus
	- ![[music_screenshot1.png]]`,

      'Transaction Log':
`Transaction logs are auto-populated from external APIs + IoT devices. They're color-coded to avoid confusion with your personal notes:
- your notes are white
+ responses from outside APIs are blue
* errors are red

+ #check-in 15 Boardwalk: Matt Smith ‚è≥ 2025-08-17 
	+ contact info: 617-123-4567
	+ check-out: [[2025-08-19]]
+ #payment Jordan Perkins: $2000 (Gmail sync)
+ #payment Maryann Cooper: $1385 (Plaid sync)
	- note: will Zelle the rest by Monday
		- [ ] #todo ping Maryann about remaining payment
+ #iot 5 Bow St: abnormal moisture levels under kitchen sink
	- [ ] #todo check kitchen sink for leaks
+ #iot 16 Pearl St: abnormally high electric usage (60kWh/day)
	- probably AC
* #iot 5 Bow St: lightbulb offline (rear hallway)`,

      'Project Note':
`This page is dedicated to a specific project, it's not part of the daily notes. The content can be in whatever format you want, only tags you assign meaning to get interpreted.

- [x] #todo apply for sprinkler permits ‚úÖ 2025-08-10
- [ ] #todo run electrical
- [x] #pay $3500 (Mario, plumbing) ‚úÖ 2025-08-17
- [ ] #urgent extend building permit`
    };
    let currentNote = 'Daily Note';
    const noteTabs = document.querySelectorAll('.note-tab');

    function parseTree(text){
      const root = [];
      const stack = [{ indent:-1, children:root }];
      const lines = (text||'').split(/\r?\n/);
      for(const line of lines){
        if(!line.trim()) continue;
        const indent = line.match(/^\s*/)[0].length;
        const clean = line.trim();
        const tags = Array.from(clean.matchAll(/#([A-Za-z0-9_-]+)/g)).map(m=>m[1].toLowerCase());
        const due = (clean.match(/\ud83d\udcc5\s*([0-9]{4}-[0-9]{2}-[0-9]{2})/)||[])[1] || (clean.match(/\b(202[4-9]-[01]\d-[0-3]\d)\b/)||[])[1] || '';
        const url = (clean.match(/https?:\/\/\S+/)||[])[0] || '';
        const textContent = clean
          .replace(/^[-*]\s*\[[x\s]\]\s*/i,'')
          .replace(/^[-*]\s*/,'')
          .replace(/#[A-Za-z0-9_-]+/g,'')
          .replace(/\ud83d\udcc5\s*[0-9\/-]+/g,'')
          .replace(url,'')
          .replace(/\s{2,}/g,' ').trim();
        const node = { text:textContent, tags, due, url, children:[] };
        while(stack.length && indent <= stack[stack.length-1].indent) stack.pop();
        stack[stack.length-1].children.push(node);
        stack.push({ indent, children: node.children });
      }
      return root;
    }

    function collectFromNote(name, text){
      return parseTree(text).filter(n=>n.tags.length).map(n=>({
        title:n.text,
        tags:n.tags,
        due:n.due,
        url:n.url,
        view:n.tags.includes('music') ? 'music' : 'task',
        source:name,
        children:n.children
      }));
    }

    function currentItems(){
      const base = collectFromNote(currentNote, cm.getValue());
      if(includePadEl?.checked){
        const others = Object.keys(NOTES).filter(n=>n!==currentNote).flatMap(n=>collectFromNote(n, NOTES[n]));
        return base.concat(others);
      }
      return base;
    }

    function tagColor(str){
      let h = 0;
      for (let i = 0; i < str.length; i++) h = str.charCodeAt(i) + ((h << 5) - h);
      return `hsl(${h % 360},70%,60%)`;
    }

    function badge(tag){
      const clean = tag.replace('#','');
      return `<span class="badge" style="background:${tagColor(clean)};">${tag}</span>`;
    }

    function tableHTML(title, items){
      if(!items.length) return '';
      return `<div class="card table-wrap"><div style="font-weight:700;margin:3px 8px;">${title}</div><table><tbody>${
        items.map(i=>`<tr class="item" data-note="${i.source}"><td>${renderMainLine(i)}</td></tr>${i.children.length?`<tr class="details"><td><ul>${i.children.map(renderChildLine).join('')}</ul></td></tr>`:''}`).join('')
      }</tbody></table></div>`;
    }

    function styleEditorTags(){
      const tags = cm.getWrapperElement().querySelectorAll('.cm-tag');
      tags.forEach(el=>{
        const clean = el.textContent.replace('#','');
        el.style.background = tagColor(clean);
      });
    }

    function matchHeights(){
      const notePanel = document.getElementById('notePanel');
      const previewPanel = document.getElementById('previewPanel');
      const editorWrap = document.getElementById('editorWrap');
      if(notePanel && previewPanel && editorWrap){
        notePanel.style.height = previewPanel.offsetHeight + 'px';
        cm.setSize(null, editorWrap.clientHeight);
      }
    }

    function render(){
      if(!containerEl) return;
      const items = currentItems();
      const todos = items.filter(i=>i.view === 'task');
      const music = items.filter(i=>i.view === 'music');
      containerEl.innerHTML = tableHTML('Todos', todos) + tableHTML('Music', music);
      containerEl.querySelectorAll('tr.item').forEach(row=>{
        row.addEventListener('click',()=>{
          const next = row.nextElementSibling;
          if(next) next.classList.toggle('show');
        });
      });
      containerEl.querySelectorAll('.note-link').forEach(a=>{
        a.addEventListener('click',e=>{ e.preventDefault(); e.stopPropagation(); loadNote(a.dataset.note); });
      });
      styleEditorTags();
      matchHeights();
    }

    if(includePadEl) includePadEl.addEventListener('input', render);

    function loadNote(name){
      currentNote = name;
      noteTabs.forEach(b=>b.classList.toggle('active', b.dataset.note===name));
      cm.setValue(NOTES[name]||'');
      render();
    }

    noteTabs.forEach(btn=>btn.addEventListener('click',()=>loadNote(btn.dataset.note)));

    function renderMainLine(i){
      const tags = i.tags.map(t=>badge('#'+t)).join(' ');
      const due = i.due?` <span class="due">${i.due}</span>`:'';
      const link = `<a href="#" class="note-link" data-note="${i.source}">${i.source}</a>`;
      const url = i.url?` <a href="${i.url}" target="_blank">${i.url}</a>`:'';
      return `${tags} ${i.title}${due} ${link}${url}`;
    }

    function renderChildLine(c){
      const tags = c.tags.map(t=>badge('#'+t)).join(' ');
      const due = c.due?` <span class="due">${c.due}</span>`:'';
      const url = c.url?` <a href="${c.url}" target="_blank">${c.url}</a>`:'';
      return `<li>${tags} ${c.text}${due}${url}</li>`;
    }

    // Footer year + theme how-to
    const yearEl = document.getElementById('year'); if(yearEl) yearEl.textContent = new Date().getFullYear();
    const themeBtn = document.getElementById('copyThemeBtn'); if(themeBtn) themeBtn.addEventListener('click', (e)=>{ e.preventDefault(); alert(`To inherit your Obsidian theme:\n\n1) Open .obsidian/themes/<YourTheme>.css\n2) Copy the CSS variable block (e.g. :root { --background-primary: ... })\n3) Paste into this file's :root and :root[data-theme="dark"] sections.\n4) Save and refresh.`); });
    
    // Initial render
    loadNote(currentNote);
    </script>    
</body>
</html>

